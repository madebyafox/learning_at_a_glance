<canvas id="canvas"></canvas>
<script src="SAT.js"></script>

<style>
* { margin:0; padding:0; } /* to remove the top and left whitespace */
html, body { width:100%; height:100%; } /* just to be sure these are full screen*/
canvas { display:block; } /* To remove the scrollbars */
</style>
<script>
(function() {
    var canvas = document.getElementById('canvas'),
            context = canvas.getContext('2d');

    // resize the canvas to fill browser window dynamically
    window.addEventListener('resize', resizeCanvas, false);

    function resizeCanvas() {
            canvas.width  = window.innerWidth;
            canvas.height = window.innerHeight;

            /**
             * Your drawings need to be inside this function otherwise they will be reset when 
             * you resize the browser window and the canvas goes will be cleared.
             */
            collider_circles = drawStuff(); //TODO: maybe make the collider circles in a seperate function?
            return collider_circles; 
    }
    collider_circles = resizeCanvas();

    function drawStuff() { 
        var winW = window.innerWidth;
        var winH = window.innerHeight;
        var nrows = 3;
        var ncols = 3;
        var radius = 60;
        var collider_circles = [];
        var pics = ["cod", "haddock", "halibut", "herring", "lesser.weaver", "mackeral",                                         "monkfish","salmon","scab"];
        var counter = 0;
				var images = {};
        for (i = 1; i <= nrows; i++) { 
            for (z = 1; z <= ncols; z++) {
                var right = (i/ncols)*winW - (1/(nrows*2))*winW;
                var down =  (z/nrows)*winH - (1/(ncols*2))*winH;
                var the_point = new SAT.Vector(right,down);
                //drawCircle(right,down,radius); //so we can see the trigger areas
                
                //now we create an array of collider objects to trigger events from mouse or gaze
                collider_circles.push(new SAT.Circle(the_point, radius));
                var end_ix = collider_circles.length-1;
                console.log('collider_circles.length:', i,z);  

                //document.title = pics[counter];
                place_img(right,down,pics[counter],images[counter]); //place centered image

                counter += 1;
            }
        }
        return collider_circles;
    }
    
    function update(collider_circles,mouse_point){//call this every few ms with setInterval 
        var which_collided = -1;
        for(var key in collider_circles){               
            var isColliding = SAT.pointInCircle(mouse_point, collider_circles[key]);
            if(isColliding){
                //console.log("Collision array number" + key + " ms.");
                which_collided = key;
            }             
        }
            //this changes the title to the number of the object that the mouse is on
//        if(which_collided>-1){
//           document.title = which_collided
//        } else{
//           document.title = "?"
//        }
    }

    function place_img(px_right,px_down,img_name,base_image){
      base_image = new Image();
      
        
      base_image.onload = function(){
      context.drawImage(base_image, px_right - (this.width/2), px_down - (this.height/2));
      context.fillText("img/fish/" + img_name + ".png",px_right,px_down);
      }
			base_image.src = "img/fish/" + img_name + ".png";
    }
    
    function drawCircle(px_right,px_down,radius){
        var c=document.getElementById("canvas");
        var ctx=c.getContext("2d");
        ctx.beginPath();
        ctx.arc(px_right,px_down,radius,0,2*Math.PI);
        ctx.stroke();
    }
    
    mouse_point = new SAT.Vector(0, 0)

    document.onmousemove = function(mouse){
        mouse_point.x = mouse.clientX;
        mouse_point.y = mouse.clientY;
    }
    setInterval(function() { update(collider_circles,mouse_point); },100)

})();

</script>